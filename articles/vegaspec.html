<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Specify using vegaspec • vegawidget</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Specify using vegaspec">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vegawidget</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/vegaspec.html">Specify using vegaspec</a>
    </li>
    <li>
      <a href="../articles/vegawidget.html">Render using vegawidget</a>
    </li>
    <li>
      <a href="../articles/shiny.html">Extend using Shiny</a>
    </li>
    <li>
      <a href="../articles/javascript.html">Extend using JavaScript</a>
    </li>
    <li>
      <a href="../articles/image.html">Create Images</a>
    </li>
    <li>
      <a href="../articles/dates-times.html">Work with Dates and Times</a>
    </li>
    <li>
      <a href="../articles/import.html">Import into Other Packages</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/vegawidget/vegawidget">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><script src="vegaspec_files/htmlwidgets-1.3/htmlwidgets.js"></script><script src="vegaspec_files/vega-4.0.0/promise.min.js"></script><script src="vegaspec_files/vega-4.0.0/symbol.min.js"></script><script src="vegaspec_files/vega-4.0.0/vega.js"></script><script src="vegaspec_files/vega-lite-2.6.0/vega-lite.min.js"></script><link href="vegaspec_files/vega-embed-3.25.0/vega-embed.css" rel="stylesheet">
<script src="vegaspec_files/vega-embed-3.25.0/vega-embed-modified.js"></script><script src="vegaspec_files/vegawidget-binding-0.1.0/vegawidget.js"></script><link href="vegaspec_files/jsoneditor-5.25.6/jsoneditor.min.css" rel="stylesheet">
<script src="vegaspec_files/jsoneditor-5.25.6/jsoneditor.min.js"></script><script src="vegaspec_files/jsonedit-binding-2.1.0/jsonedit.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Specify using vegaspec</h1>
            
            <h4 class="date">2019-02-06</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/vegawidget/vegawidget/blob/master/vignettes/vegaspec.Rmd"><code>vignettes/vegaspec.Rmd</code></a></small>
      <div class="hidden name"><code>vegaspec.Rmd</code></div>

    </div>

    
    
<p>The central <em>object</em> of this package is a <em>vegaspec</em>, short for “Vega specification”. This can refer to either a Vega or Vega-Lite specification; in our examples, we work almost exclusively with Vega-Lite.</p>
<p>This article will showcase functions that:</p>
<ul>
<li>build a vegaspec: <code><a href="../reference/as_vegaspec.html">as_vegaspec()</a></code>
</li>
<li>examine a vegaspec: <code><a href="../reference/vw_examine.html">vw_examine()</a></code>
</li>
<li>convert a vegaspec to JSON: <code><a href="../reference/vw_as_json.html">vw_as_json()</a></code>
</li>
<li>resize a vegaspec: <code><a href="../reference/vw_autosize.html">vw_autosize()</a></code>
</li>
<li>compile a Vega-Lite spec to Vega: <code><a href="../reference/vw_to_vega.html">vw_to_vega()</a></code>
</li>
</ul>
<p>The article ends with some “gotchas” (please contribute more as you find them).</p>
<div id="building" class="section level2">
<h2 class="hasAnchor">
<a href="#building" class="anchor"></a>Building</h2>
<p>A vegaspec is created using the constructor <code><a href="../reference/as_vegaspec.html">as_vegaspec()</a></code>, which takes a <code>list</code>, <code>character</code> or a <strong>jsonlite</strong> <code>json</code> object.</p>
<p>Vega and Vega-Lite expect JSON. Because it is easier, in R, to work with lists, a vegaspec “lives” as a list, and then is coerced to JSON when rendered as a vegawidget.</p>
<p>Let’s start with a bar-chart example. The <code>data_category</code> object is a sample dataset included in this package:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(<span class="st">"vegawidget"</span>)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1-3" data-line-number="3">spec_category &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(</a>
<a class="sourceLine" id="cb1-5" data-line-number="5">    <span class="st">`</span><span class="dt">$schema</span><span class="st">`</span> =<span class="st"> </span><span class="kw"><a href="../reference/vega_schema.html">vega_schema</a></span>(),</a>
<a class="sourceLine" id="cb1-6" data-line-number="6">    <span class="dt">data =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">values =</span> data_category),</a>
<a class="sourceLine" id="cb1-7" data-line-number="7">    <span class="dt">mark =</span> <span class="st">"bar"</span>,</a>
<a class="sourceLine" id="cb1-8" data-line-number="8">    <span class="dt">encoding =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(</a>
<a class="sourceLine" id="cb1-9" data-line-number="9">      <span class="dt">x =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">field =</span> <span class="st">"category"</span>, <span class="dt">type =</span> <span class="st">"nominal"</span>),</a>
<a class="sourceLine" id="cb1-10" data-line-number="10">      <span class="dt">y =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">field =</span> <span class="st">"number"</span>, <span class="dt">type =</span> <span class="st">"quantitative"</span>)</a>
<a class="sourceLine" id="cb1-11" data-line-number="11">    )</a>
<a class="sourceLine" id="cb1-12" data-line-number="12">  ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="st">  </span><span class="kw"><a href="../reference/as_vegaspec.html">as_vegaspec</a></span>()</a>
<a class="sourceLine" id="cb1-14" data-line-number="14"></a>
<a class="sourceLine" id="cb1-15" data-line-number="15">spec_category</a></code></pre></div>
<div id="htmlwidget-ca572c91c2fee8fec9cf" style="width:auto;height:auto;" class="vegawidget html-widget"></div>
<script type="application/json" data-for="htmlwidget-ca572c91c2fee8fec9cf">{"x":{
  "chart_spec": {
    "$schema": "https://vega.github.io/schema/vega-lite/v2.json",
    "data": {
      "values": [
        {
          "category": "a",
          "number": 21
        },
        {
          "category": "b",
          "number": 64
        },
        {
          "category": "c",
          "number": 23
        },
        {
          "category": "d",
          "number": 41
        },
        {
          "category": "e",
          "number": 92
        },
        {
          "category": "f",
          "number": 52
        },
        {
          "category": "g",
          "number": 61
        },
        {
          "category": "h",
          "number": 27
        },
        {
          "category": "i",
          "number": 34
        },
        {
          "category": "j",
          "number": 48
        }
      ]
    },
    "mark": "bar",
    "encoding": {
      "x": {
        "field": "category",
        "type": "nominal"
      },
      "y": {
        "field": "number",
        "type": "quantitative"
      }
    }
  },
  "embed_options": {
    "defaultStyle": true,
    "renderer": "canvas"
  }
},"evals":[],"jsHooks":[]}</script><p>Looking at the structure of <code>spec_category</code>, we see that the <code>vegaspec</code> S3 class inherits from <code>list</code>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/str">str</a></span>(spec_category)</a></code></pre></div>
<pre><code>## List of 4
##  $ $schema : chr "https://vega.github.io/schema/vega-lite/v2.json"
##  $ data    :List of 1
##   ..$ values:Classes 'tbl_df', 'tbl' and 'data.frame':   10 obs. of  2 variables:
##   .. ..$ category: chr [1:10] "a" "b" "c" "d" ...
##   .. ..$ number  : int [1:10] 21 64 23 41 92 52 61 27 34 48
##  $ mark    : chr "bar"
##  $ encoding:List of 2
##   ..$ x:List of 2
##   .. ..$ field: chr "category"
##   .. ..$ type : chr "nominal"
##   ..$ y:List of 2
##   .. ..$ field: chr "number"
##   .. ..$ type : chr "quantitative"
##  - attr(*, "class")= chr [1:3] "vegaspec_vega_lite" "vegaspec" "list"</code></pre>
<p>You can use the helper function <code><a href="../reference/vega_schema.html">vega_schema()</a></code> to generate the string for the <code>$schema</code> element, which can be useful if you are writing a vegaspec manually.</p>
</div>
<div id="examining" class="section level2">
<h2 class="hasAnchor">
<a href="#examining" class="anchor"></a>Examining</h2>
<p>We also have a function, <code><a href="../reference/vw_examine.html">vw_examine()</a></code>, that you can use to, well, examine a vegaspec. It is a thin wrapper around the <code><a href="https://www.rdocumentation.org/packages/listviewer/topics/jsonedit">listviewer::jsonedit()</a></code> function:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="../reference/vw_examine.html">vw_examine</a></span>(spec_category)</a></code></pre></div>
<div id="htmlwidget-4d2aeeb89ff3605045ae" style="width:700px;height:432.632880098888px;" class="jsonedit html-widget"></div>
<script type="application/json" data-for="htmlwidget-4d2aeeb89ff3605045ae">{"x":{"data":{
  "$schema": "https://vega.github.io/schema/vega-lite/v2.json",
  "data": {
    "values": [
      {
        "category": "a",
        "number": 21
      },
      {
        "category": "b",
        "number": 64
      },
      {
        "category": "c",
        "number": 23
      },
      {
        "category": "d",
        "number": 41
      },
      {
        "category": "e",
        "number": 92
      },
      {
        "category": "f",
        "number": 52
      },
      {
        "category": "g",
        "number": 61
      },
      {
        "category": "h",
        "number": 27
      },
      {
        "category": "i",
        "number": 34
      },
      {
        "category": "j",
        "number": 48
      }
    ]
  },
  "mark": "bar",
  "encoding": {
    "x": {
      "field": "category",
      "type": "nominal"
    },
    "y": {
      "field": "number",
      "type": "quantitative"
    }
  }
},"options":{"mode":"view","modes":["view","code","form","text","tree"]}},"evals":[],"jsHooks":[]}</script><p>You might note that, using <code><a href="https://www.rdocumentation.org/packages/utils/topics/str">str()</a></code>, the <code>data$values</code> element of the vegaspec has a column-major format. In R, data frames are lists of vectors; each of the columns is a vector. In the Vega framework, data sets have a row-major format. When rendering, this package converts data-frames automatically to row-major data.</p>
</div>
<div id="sizing" class="section level2">
<h2 class="hasAnchor">
<a href="#sizing" class="anchor"></a>Sizing</h2>
<p>Sizing can be a tricky issue in Vega-Lite.</p>
<p>The first thing to keep in mind is that the default interpretation of width and height refers to the dimensions of the data rectangle. For example, we can set <code>width</code> and <code>height</code> of our example spec:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">spec_category_size &lt;-<span class="st"> </span>spec_category</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"></a>
<a class="sourceLine" id="cb5-3" data-line-number="3">spec_category_size<span class="op">$</span>width  &lt;-<span class="st"> </span><span class="dv">300</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4">spec_category_size<span class="op">$</span>height &lt;-<span class="st"> </span><span class="dv">300</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"></a>
<a class="sourceLine" id="cb5-6" data-line-number="6">spec_category_size</a></code></pre></div>
<div id="htmlwidget-1935dd1673adf193b564" style="width:auto;height:auto;" class="vegawidget html-widget"></div>
<script type="application/json" data-for="htmlwidget-1935dd1673adf193b564">{"x":{
  "chart_spec": {
    "$schema": "https://vega.github.io/schema/vega-lite/v2.json",
    "data": {
      "values": [
        {
          "category": "a",
          "number": 21
        },
        {
          "category": "b",
          "number": 64
        },
        {
          "category": "c",
          "number": 23
        },
        {
          "category": "d",
          "number": 41
        },
        {
          "category": "e",
          "number": 92
        },
        {
          "category": "f",
          "number": 52
        },
        {
          "category": "g",
          "number": 61
        },
        {
          "category": "h",
          "number": 27
        },
        {
          "category": "i",
          "number": 34
        },
        {
          "category": "j",
          "number": 48
        }
      ]
    },
    "mark": "bar",
    "encoding": {
      "x": {
        "field": "category",
        "type": "nominal"
      },
      "y": {
        "field": "number",
        "type": "quantitative"
      }
    },
    "width": 300,
    "height": 300
  },
  "embed_options": {
    "defaultStyle": true,
    "renderer": "canvas"
  }
},"evals":[],"jsHooks":[]}</script><p>Here, the data rectangle is 300 <span class="math inline">\(\times\)</span> 300 pixels, according to our specification.</p>
<p><img src="autosize-off.png" width="710"></p>
<p>As you can see above, Vega adds on more “room” for axes, labels, legends, etc., so that the entire chart is 357 <span class="math inline">\(\times\)</span> 347 pixels.</p>
<p>If we want to specify the dimensions of the entire chart, we can use the <code><a href="../reference/vw_autosize.html">vw_autosize()</a></code> function. The term “autosize” is taken directly from the Vega <a href="https://vega.github.io/vega-lite/docs/size.html#autosize">documentation</a> for sizing. In this context, the term “autosize” does <strong>not</strong> mean that Vega will try to find the optimal sizing for your chart.</p>
<p>Instead, it means that if you have a requirement for the dimensions of the entire chart, Vega will try to adjust the chart to meet these sizing requirements. The <code><a href="../reference/vw_autosize.html">vw_autosize()</a></code> function modifies the vegaspec to provide Vega these instructions.</p>
<p>Here’s an example:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">spec_category_autosize &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="st">  </span>spec_category <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="../reference/vw_autosize.html">vw_autosize</a></span>(<span class="dt">width =</span> <span class="dv">300</span>, <span class="dt">height =</span> <span class="dv">300</span>)</a>
<a class="sourceLine" id="cb6-4" data-line-number="4"></a>
<a class="sourceLine" id="cb6-5" data-line-number="5">spec_category_autosize</a></code></pre></div>
<div id="htmlwidget-1e3d06c16dc694d24464" style="width:auto;height:auto;" class="vegawidget html-widget"></div>
<script type="application/json" data-for="htmlwidget-1e3d06c16dc694d24464">{"x":{
  "chart_spec": {
    "$schema": "https://vega.github.io/schema/vega-lite/v2.json",
    "data": {
      "values": [
        {
          "category": "a",
          "number": 21
        },
        {
          "category": "b",
          "number": 64
        },
        {
          "category": "c",
          "number": 23
        },
        {
          "category": "d",
          "number": 41
        },
        {
          "category": "e",
          "number": 92
        },
        {
          "category": "f",
          "number": 52
        },
        {
          "category": "g",
          "number": 61
        },
        {
          "category": "h",
          "number": 27
        },
        {
          "category": "i",
          "number": 34
        },
        {
          "category": "j",
          "number": 48
        }
      ]
    },
    "mark": "bar",
    "encoding": {
      "x": {
        "field": "category",
        "type": "nominal"
      },
      "y": {
        "field": "number",
        "type": "quantitative"
      }
    },
    "width": 300,
    "height": 300,
    "config": {
      "autosize": {
        "type": "fit",
        "contains": "padding"
      },
      "view": {
        "width": 300,
        "height": 300
      }
    }
  },
  "embed_options": {
    "defaultStyle": true,
    "renderer": "canvas"
  }
},"evals":[],"jsHooks":[]}</script><p>In this context, the <code>width</code> and <code>height</code> are defined as the dimensions of the entire plot including axes, labels, padding, etc. Here, we have specified the overall dimensions to be 300 <span class="math inline">\(\times\)</span> 300 pixels:</p>
<p><img src="autosize-on.png" width="710"></p>
<p>As you can see above, Vega takes into account the “room” needed for axes, labels, legends, etc., so that the data rectangle is 243 <span class="math inline">\(\times\)</span> 253 pixels.</p>
<p>There are limitations to autosizing; the most prominent is that specifying width and height is <a href="https://vega.github.io/vega-lite/docs/size.html#limitations">effective only for single-view and layered specifications</a>. It will not work for specifications with multiple views (e.g. <code>hconcat</code>, <code>vconcat</code>, <code>facet</code>, <code>`repeat`</code>); this will issue a warning that there will be no effect on the specification when rendered.</p>
<p>For more information, see the Vega-Lite documentation on <a href="https://vega.github.io/vega-lite/docs/size.html#autosize">autosizing</a>.</p>
</div>
<div id="compile-to-vega" class="section level2">
<h2 class="hasAnchor">
<a href="#compile-to-vega" class="anchor"></a>Compile to Vega</h2>
<p>When rendering a Vega-Lite specification, the vega-lite JavaScript library will compile the Vega-Lite specification into Vega. If you have the <a href="https://nodejs.org/en/"><strong>node</strong></a> installed, and want to compile a Vega-Lite specification to Vega, for your own purposes, you can use the <code><a href="../reference/vw_to_vega.html">vw_to_vega()</a></code> function.</p>
<p>To be clear, if you are using only Vega-Lite, this is not something you should ever need to do. This may be useful if you need to design a specification using Vega, and you want get things started using a Vega-Lite specification.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">spec_category_vega &lt;-<span class="st"> </span><span class="kw"><a href="../reference/vw_to_vega.html">vw_to_vega</a></span>(spec_category)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"></a>
<a class="sourceLine" id="cb7-3" data-line-number="3">spec_category_vega</a></code></pre></div>
<div id="htmlwidget-75d841b77d31ea4bb159" style="width:auto;height:auto;" class="vegawidget html-widget"></div>
<script type="application/json" data-for="htmlwidget-75d841b77d31ea4bb159">{"x":{
  "chart_spec": {
    "$schema": "https://vega.github.io/schema/vega/v3.json",
    "autosize": "pad",
    "padding": 5,
    "height": 200,
    "style": "cell",
    "data": [
      {
        "name": "source_0",
        "values": [
          {
            "category": "a",
            "number": 21
          },
          {
            "category": "b",
            "number": 64
          },
          {
            "category": "c",
            "number": 23
          },
          {
            "category": "d",
            "number": 41
          },
          {
            "category": "e",
            "number": 92
          },
          {
            "category": "f",
            "number": 52
          },
          {
            "category": "g",
            "number": 61
          },
          {
            "category": "h",
            "number": 27
          },
          {
            "category": "i",
            "number": 34
          },
          {
            "category": "j",
            "number": 48
          }
        ]
      },
      {
        "name": "data_0",
        "source": "source_0",
        "transform": [
          {
            "type": "formula",
            "expr": "toNumber(datum[\"number\"])",
            "as": "number"
          },
          {
            "type": "filter",
            "expr": "datum[\"number\"] !== null && !isNaN(datum[\"number\"])"
          }
        ]
      }
    ],
    "signals": [
      {
        "name": "x_step",
        "value": 21
      },
      {
        "name": "width",
        "update": "bandspace(domain('x').length, 0.1, 0.05) * x_step"
      }
    ],
    "marks": [
      {
        "name": "marks",
        "type": "rect",
        "style": [
          "bar"
        ],
        "from": {
          "data": "data_0"
        },
        "encode": {
          "update": {
            "fill": {
              "value": "#4c78a8"
            },
            "x": {
              "scale": "x",
              "field": "category"
            },
            "width": {
              "scale": "x",
              "band": true
            },
            "y": {
              "scale": "y",
              "field": "number"
            },
            "y2": {
              "scale": "y",
              "value": 0
            }
          }
        }
      }
    ],
    "scales": [
      {
        "name": "x",
        "type": "band",
        "domain": {
          "data": "data_0",
          "field": "category",
          "sort": true
        },
        "range": {
          "step": {
            "signal": "x_step"
          }
        },
        "paddingInner": 0.1,
        "paddingOuter": 0.05
      },
      {
        "name": "y",
        "type": "linear",
        "domain": {
          "data": "data_0",
          "field": "number"
        },
        "range": [
          {
            "signal": "height"
          },
          0
        ],
        "nice": true,
        "zero": true
      }
    ],
    "axes": [
      {
        "scale": "x",
        "orient": "bottom",
        "grid": false,
        "title": "category",
        "encode": {
          "labels": {
            "update": {
              "angle": {
                "value": 270
              },
              "align": {
                "value": "right"
              },
              "baseline": {
                "value": "middle"
              }
            }
          }
        },
        "zindex": 1
      },
      {
        "scale": "y",
        "orient": "left",
        "grid": false,
        "title": "number",
        "labelOverlap": true,
        "tickCount": {
          "signal": "ceil(height/40)"
        },
        "zindex": 1
      },
      {
        "scale": "y",
        "orient": "left",
        "grid": true,
        "tickCount": {
          "signal": "ceil(height/40)"
        },
        "gridScale": "x",
        "domain": false,
        "labels": false,
        "maxExtent": 0,
        "minExtent": 0,
        "ticks": false,
        "zindex": 0
      }
    ],
    "config": {
      "axisY": {
        "minExtent": 30
      }
    }
  },
  "embed_options": {
    "defaultStyle": true,
    "renderer": "canvas"
  }
},"evals":[],"jsHooks":[]}</script><p>We can use the <code><a href="../reference/vw_spec_version.html">vw_spec_version()</a></code> function to check the version of the specification:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw"><a href="../reference/vw_spec_version.html">vw_spec_version</a></span>(spec_category_vega)</a></code></pre></div>
<pre><code>## $library
## [1] "vega"
## 
## $version
## [1] "3"</code></pre>
<p>You can examine the result to see how much-more verbose is the Vega specification, compared to the Vega-Lite specification.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw"><a href="../reference/vw_examine.html">vw_examine</a></span>(spec_category_vega)</a></code></pre></div>
<div id="htmlwidget-b862151a938f346a8665" style="width:700px;height:432.632880098888px;" class="jsonedit html-widget"></div>
<script type="application/json" data-for="htmlwidget-b862151a938f346a8665">{"x":{"data":{
  "$schema": "https://vega.github.io/schema/vega/v3.json",
  "autosize": "pad",
  "padding": 5,
  "height": 200,
  "style": "cell",
  "data": [
    {
      "name": "source_0",
      "values": [
        {
          "category": "a",
          "number": 21
        },
        {
          "category": "b",
          "number": 64
        },
        {
          "category": "c",
          "number": 23
        },
        {
          "category": "d",
          "number": 41
        },
        {
          "category": "e",
          "number": 92
        },
        {
          "category": "f",
          "number": 52
        },
        {
          "category": "g",
          "number": 61
        },
        {
          "category": "h",
          "number": 27
        },
        {
          "category": "i",
          "number": 34
        },
        {
          "category": "j",
          "number": 48
        }
      ]
    },
    {
      "name": "data_0",
      "source": "source_0",
      "transform": [
        {
          "type": "formula",
          "expr": "toNumber(datum[\"number\"])",
          "as": "number"
        },
        {
          "type": "filter",
          "expr": "datum[\"number\"] !== null && !isNaN(datum[\"number\"])"
        }
      ]
    }
  ],
  "signals": [
    {
      "name": "x_step",
      "value": 21
    },
    {
      "name": "width",
      "update": "bandspace(domain('x').length, 0.1, 0.05) * x_step"
    }
  ],
  "marks": [
    {
      "name": "marks",
      "type": "rect",
      "style": [
        "bar"
      ],
      "from": {
        "data": "data_0"
      },
      "encode": {
        "update": {
          "fill": {
            "value": "#4c78a8"
          },
          "x": {
            "scale": "x",
            "field": "category"
          },
          "width": {
            "scale": "x",
            "band": true
          },
          "y": {
            "scale": "y",
            "field": "number"
          },
          "y2": {
            "scale": "y",
            "value": 0
          }
        }
      }
    }
  ],
  "scales": [
    {
      "name": "x",
      "type": "band",
      "domain": {
        "data": "data_0",
        "field": "category",
        "sort": true
      },
      "range": {
        "step": {
          "signal": "x_step"
        }
      },
      "paddingInner": 0.1,
      "paddingOuter": 0.05
    },
    {
      "name": "y",
      "type": "linear",
      "domain": {
        "data": "data_0",
        "field": "number"
      },
      "range": [
        {
          "signal": "height"
        },
        0
      ],
      "nice": true,
      "zero": true
    }
  ],
  "axes": [
    {
      "scale": "x",
      "orient": "bottom",
      "grid": false,
      "title": "category",
      "encode": {
        "labels": {
          "update": {
            "angle": {
              "value": 270
            },
            "align": {
              "value": "right"
            },
            "baseline": {
              "value": "middle"
            }
          }
        }
      },
      "zindex": 1
    },
    {
      "scale": "y",
      "orient": "left",
      "grid": false,
      "title": "number",
      "labelOverlap": true,
      "tickCount": {
        "signal": "ceil(height/40)"
      },
      "zindex": 1
    },
    {
      "scale": "y",
      "orient": "left",
      "grid": true,
      "tickCount": {
        "signal": "ceil(height/40)"
      },
      "gridScale": "x",
      "domain": false,
      "labels": false,
      "maxExtent": 0,
      "minExtent": 0,
      "ticks": false,
      "zindex": 0
    }
  ],
  "config": {
    "axisY": {
      "minExtent": 30
    }
  }
},"options":{"mode":"view","modes":["view","code","form","text","tree"]}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="gotchas" class="section level2">
<h2 class="hasAnchor">
<a href="#gotchas" class="anchor"></a>Gotchas</h2>
<p>There are a few things to keep your eyes open-for if you are building vegaspec:</p>
<ul>
<li><p>If the JSON needs a <code>null</code>, supply a <code>NULL</code> from R.</p></li>
<li><p>If the JSON needs an element called <code>repeat</code>, keep in mind that this is a reserved word in R. You can specify such an element using backticks, e.g. <code><a href="https://www.rdocumentation.org/packages/base/topics/list">list(`repeat` =  ...)</a></code>.</p></li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#building">Building</a></li>
      <li><a href="#examining">Examining</a></li>
      <li><a href="#sizing">Sizing</a></li>
      <li><a href="#compile-to-vega">Compile to Vega</a></li>
      <li><a href="#gotchas">Gotchas</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Ian Lyttle, Vega/Vega-Lite Developers.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
